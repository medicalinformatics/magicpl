<?xml version="1.0" encoding="UTF-8"?>
<pathconfig xmlns="http://www.example.org/Pfade" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://www.example.org/Pfade paths.xsd ">

    <paths>
        <!-- /paths/getId
          * Schritte 1,10 im DSK
          * Zuständige Komponentente: Lokales ID-Mgmt
        -->
        <path>
            <name>getId</name>
            <parameters/>
            <input>
                <iorecord ref="IDAT" />
                <iosingle ref="Einwilligungsstatus" />
            </input>
            <output>
                <iosingle/>
                <iorecord/>
            </output>
            <switch>
                <evaluator name="IsConsentedEvaluator"/>
                <case value="true">
                    <!--
                       * Schritte 2,5,6,8 GRÜN in DSK
                       * Teilpfade: /paths/getKNTKT
                       *            /paths/getDKTKId
                    -->
                    <multipath>
                        <name>getDKTKId</name>
                        <parameters/>
                        <input>
                            <iorecord ref="IDAT" />
                            <iosingle ref="Einwilligungsstatus" />
                        </input>
                        <output>
                            <iosingle ref="DKTK#ID" />
                        </output>
                        <step>
                            <!-- /paths/getKNTKT
                             * Schritt 2,5 GRÜN in DSK
                             * Zuständige Komponente: Zentraler KNE
                            -->
                            <name>getKNTKT</name>
                            <input>
                                <iorecord ref="IDAT" />
                            </input>
                            <output>
                                <iosingle ref="KNTKT#ID" />
                            </output>
                            <implementation>de.mainzelliste.paths.processor.CngClient</implementation>
                        </step>
                        <step>
                            <!-- /paths/generateId
                             * Schritte 6,8 GRÜN in DSK
                             * Zuständige Komponente: Mainzelliste (RL)
                            -->
                            <name>getDKTKId</name>
                            <parameters/>
                            <input>
                                <iosingle ref="KNTKT#ID" />
                            </input>
                            <output>
                                <iosingle ref="DKTK#ID" />
                            </output>
                            <implementation>de.mainzelliste.paths.processor.MainzellisteClient</implementation>
                        </step>
                    </multipath>
                </case>
                <case value="false">
                    <!--
                       * Schritte 2,5,6,8 GRÜN in DSK
                       * Teilpfade: /paths/getKNTKT
                       *            /paths/getDKTKId
                    -->
                    <multipath>
                        <name>getLocalId</name>
                        <parameters/>
                        <input>
                            <iorecord ref="IDAT"/>
                            <iosingle ref="IDType"/>
                            <iosingle ref="Einwilligungsstatus"/>
                        </input>
                        <output>
                            <iosingle ref="S#ID"/>
                        </output>
                        <step>
                            <!-- /paths/getKNTKT
                             * Schritt 2,5 GRÜN in DSK
                             * Zuständige Komponente: Zentraler KNE
                            -->
                            <name>getKN</name>
                            <input>
                                <iorecord ref="IDAT"/>
                                <!--<iosingle ref="IDType"/>-->
                            </input>
                            <output>
                                <iosingle ref="KN"/>
                            </output>
                            <implementation>de.mainzelliste.paths.processor.CNGeneratorProcessor</implementation>
                        </step>
                        <step>
                            <!-- /paths/generateId
                             * Schritte 6,8 GRÜN in DSK
                             * Zuständige Komponente: Mainzelliste (RL)
                            -->
                            <name>getKNTKT</name>
                            <parameters>
                                <parameter name="mainzellisteURL">localhost:8084/mainzelliste-dktk</parameter>
                                <parameter name="mainzellisteApiKey">89708d51eda036b346a9ed46cd190a80</parameter>
                            </parameters>
                            <input>
                                <iosingle ref="KN"/>
                                <iosingle ref="IDType"/>
                            </input>
                            <output>
                                <iosingle ref="KNTKT#ID"/>
                            </output>
                            <implementation>de.mainzelliste.paths.processor.MainzellisteKNTicketClient</implementation>
                        </step>
                        <step>
                            <!-- /paths/generateId
                             * Schritte 6,8 GRÜN in DSK
                             * Zuständige Komponente: Mainzelliste (RL)
                            -->
                            <name>getDKTKId</name>
                            <parameters/>
                            <input>
                                <iosingle ref="KNTKT#ID"/>
                            </input>
                            <output>
                                <iosingle ref="DKTK#ID"/>
                            </output>
                            <implementation>de.mainzelliste.paths.processor.MainzellisteClient</implementation>
                        </step>
                    </multipath>
                </case>
            </switch>
        </path>
    </paths>

    <iodefinitions>
        <iorecord name="IDAT">
            <iosingle name="vorname"/>
            <iosingle name="nachname"/>
            <iosingle name="geburtsdatum"/>
        </iorecord>
        <iosingle name="Einwilligungsstatus" type="boolean"/>
        <iosingle name="IDType"/>
        <iosingle name="DKTK#ID"/>
        <iosingle name="KNTKT" />
    </iodefinitions>

</pathconfig>